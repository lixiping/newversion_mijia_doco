{"version":3,"sources":["../../src/data/fill.js"],"names":["fill","dataTree","fillRec","node","descendantsVDOM","vdom","descendantsVDOMData","data","newChildren","children","map","res","indexOf","push","forEach","i","module","exports"],"mappings":";;;;AAAA;;AAEA,SAASA,IAAT,CAAcC,QAAd,EAAwB;AACtB,WAASC,OAAT,CAAiBC,IAAjB,EAAuB;AACrB;AACA,QAAIC,kBAAkB,CAACD,KAAKE,IAAN,CAAtB;AAAA,QACEC,sBAAsB,CAACH,KAAKI,IAAN,CADxB;AAEA,QAAMC,cAAcL,KAAKI,IAAL,CAAUE,QAAV,CAAmBC,GAAnB,CAAuB,gBAAQ;AACjD,UAAMC,MAAMT,QAAQC,IAAR,CAAZ;AACA,UAAIC,gBAAgBQ,OAAhB,CAAwBD,IAAIN,IAA5B,MAAsC,CAAC,CAA3C,EAA8C;AAC5CD,wBAAgBS,IAAhB,CAAqBF,IAAIN,IAAzB;AACAC,4BAAoBO,IAApB,CAAyBF,IAAIJ,IAA7B;AACD;AACDI,UAAIP,eAAJ,CAAoBU,OAApB,CAA4B,UAACT,IAAD,EAAOU,CAAP,EAAa;AACvC,YAAIX,gBAAgBQ,OAAhB,CAAwBP,IAAxB,MAAkC,CAAC,CAAvC,EAA0C;AACxCD,0BAAgBS,IAAhB,CAAqBR,IAArB;AACAC,8BAAoBO,IAApB,CAAyBF,IAAIL,mBAAJ,CAAwBS,CAAxB,CAAzB;AACD;AACF,OALD;AAMA,aAAOJ,GAAP;AACD,KAbmB,CAApB;AAcA,wBACKR,IADL;AAEEI,yBAAWJ,KAAKI,IAAhB,IAAsBE,UAAUD,WAAhC,GAFF;AAGEJ,sCAHF;AAIEE;AAJF;AAMD;AACD,SAAOJ,QAAQ,EAAEK,MAAMN,QAAR,EAAR,EAA4BM,IAAnC;AACD;;AAEDS,OAAOC,OAAP,GAAiBjB,IAAjB","file":"fill.js","sourcesContent":["// fill the result of build() with more information that will make resolve() more efficient\n\nfunction fill(dataTree) {\n  function fillRec(node) {\n    // we compute all the descendants vdom under the current node\n    let descendantsVDOM = [node.vdom],\n      descendantsVDOMData = [node.data];\n    const newChildren = node.data.children.map(node => {\n      const res = fillRec(node);\n      if (descendantsVDOM.indexOf(res.vdom) === -1) {\n        descendantsVDOM.push(res.vdom);\n        descendantsVDOMData.push(res.data);\n      }\n      res.descendantsVDOM.forEach((vdom, i) => {\n        if (descendantsVDOM.indexOf(vdom) === -1) {\n          descendantsVDOM.push(vdom);\n          descendantsVDOMData.push(res.descendantsVDOMData[i]);\n        }\n      });\n      return res;\n    });\n    return {\n      ...node,\n      data: { ...node.data, children: newChildren },\n      descendantsVDOM,\n      descendantsVDOMData\n    };\n  }\n  return fillRec({ data: dataTree }).data;\n}\n\nmodule.exports = fill;\n"]}